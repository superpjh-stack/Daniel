import type { BlockType, AnimalInfo } from './types';

// Í∞Å Î∏îÎ°ùÏùò 4ÌöåÏ†Ñ ÏÉÅÌÉú (4√ó4 Îß§Ìä∏Î¶≠Ïä§)
export const BLOCK_SHAPES: Record<BlockType, number[][][]> = {
  I: [
    [[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],
    [[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],
    [[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],
    [[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],
  ],
  O: [
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
  ],
  T: [
    [[0,1,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,0,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]],
    [[0,0,0,0],[1,1,1,0],[0,1,0,0],[0,0,0,0]],
    [[0,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],
  ],
  S: [
    [[0,1,1,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,0,0],[0,1,1,0],[0,0,1,0],[0,0,0,0]],
    [[0,0,0,0],[0,1,1,0],[1,1,0,0],[0,0,0,0]],
    [[1,0,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],
  ],
  Z: [
    [[1,1,0,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,0,1,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]],
    [[0,0,0,0],[1,1,0,0],[0,1,1,0],[0,0,0,0]],
    [[0,1,0,0],[1,1,0,0],[1,0,0,0],[0,0,0,0]],
  ],
  L: [
    [[0,0,1,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,0,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]],
    [[0,0,0,0],[1,1,1,0],[1,0,0,0],[0,0,0,0]],
    [[1,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],
  ],
  J: [
    [[1,0,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],
    [[0,0,0,0],[1,1,1,0],[0,0,1,0],[0,0,0,0]],
    [[0,1,0,0],[0,1,0,0],[1,1,0,0],[0,0,0,0]],
  ],
  Q: [
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
  ],
};

export const ANIMALS: Record<BlockType, AnimalInfo> = {
  I: { name: 'Î±Ä',     emoji: 'üêç', weight: 2, color: '#22c55e' },
  O: { name: 'ÏΩîÎÅºÎ¶¨', emoji: 'üêò', weight: 5, color: '#9ca3af' },
  T: { name: 'ÏÇ¨Ïûê',   emoji: 'ü¶Å', weight: 3, color: '#f97316' },
  S: { name: 'Ïñë',     emoji: 'üêë', weight: 2, color: '#e2e8f0' },
  Z: { name: 'ÎèÖÏàòÎ¶¨', emoji: 'ü¶Ö', weight: 2, color: '#92400e' },
  L: { name: 'Í∏∞Î¶∞',   emoji: 'ü¶í', weight: 3, color: '#eab308' },
  J: { name: 'Í≥∞',     emoji: 'üêª', weight: 4, color: '#78350f' },
  Q: { name: 'ÎπÑÎëòÍ∏∞', emoji: 'üïäÔ∏è', weight: 1, color: '#fbbf24' },
};

const STANDARD_TYPES: BlockType[] = ['I', 'O', 'T', 'S', 'Z', 'L', 'J'];

// 7-bag ÎûúÎç§: 7Ï¢Ö Î∏îÎ°ù Ìïú ÏÑ∏Ìä∏ ÏÖîÌîå
export function createBag(): BlockType[] {
  const bag = [...STANDARD_TYPES];
  for (let i = bag.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [bag[i], bag[j]] = [bag[j], bag[i]];
  }
  return bag;
}

export function getBlockShape(type: BlockType, rotation: number): number[][] {
  return BLOCK_SHAPES[type][rotation % 4];
}
