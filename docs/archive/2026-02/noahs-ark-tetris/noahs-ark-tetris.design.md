# Noah's Ark: Logic Fit Design Document

> **Summary**: ë…¸ì•„ì˜ ë°©ì£¼ í…ŒíŠ¸ë¦¬ìŠ¤í˜• í¼ì¦ ê²Œì„ì˜ ìƒì„¸ ê¸°ìˆ  ì„¤ê³„
>
> **Project**: ë‹¤ë‹ˆì—˜ - ë™ì€êµíšŒ ì´ˆë“±ë¶€ ì¶œì„ë¶€
> **Author**: AI Assistant
> **Date**: 2026-02-16
> **Status**: Draft
> **Planning Doc**: [noahs-ark-tetris.plan.md](../../01-plan/features/noahs-ark-tetris.plan.md)

---

## 1. Overview

### 1.1 Design Goals

- HTML5 Canvas ê¸°ë°˜ 60fps í…ŒíŠ¸ë¦¬ìŠ¤í˜• í¼ì¦ ê²Œì„ ì—”ì§„
- ë™ë¬¼ ë¸”ë¡ + ë°©ì£¼ ê· í˜• ë¬¼ë¦¬ë¡œ ì°¨ë³„í™”ëœ ê²Œì„ ê²½í—˜
- ë¹„/ë¬´ì§€ê°œ íŒŒí‹°í´ ì—°ì¶œë¡œ ì„±ê²½ ìŠ¤í† ë¦¬ ì „ë‹¬
- ë…¸ì•„ ë°©ì£¼ ê´€ë ¨ í€´ì¦ˆ í†µí•© (í•˜ë“œì½”ë”© 15ë¬¸ì œ)
- ê¸°ì¡´ brick-breaker íŒ¨í„´ ì¬í™œìš© (ë³´ìƒ API, í•™ìƒ ì„ íƒ, ëª¨ë‹¬)
- ëª¨ë°”ì¼ í„°ì¹˜(ìŠ¤ì™€ì´í”„ + ë²„íŠ¼) / ë°ìŠ¤í¬í†± í‚¤ë³´ë“œ ì§€ì›

### 1.2 Design Principles

- Client-side ê²Œì„ ë¡œì§ (Canvas + React hooks) â€” brick-breaker ë™ì¼ íŒ¨í„´
- Server-side ë³´ìƒ ì²˜ë¦¬ (ë³´ì•ˆ/ê²€ì¦)
- ì™¸ë¶€ ê²Œì„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¯¸ì‚¬ìš© (ìˆœìˆ˜ Canvas API)
- ì½”ë“œ ì¬ì‚¬ìš©: QuizModal, GameOverModal êµ¬ì¡°ë¥¼ ì°¸ì¡°í•˜ë˜ ë…¸ì•„ í…Œë§ˆ ì ìš©

---

## 2. Architecture

### 2.1 Component Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser (Client)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Games List  â”‚  â”‚  Noah's Ark Game                â”‚   â”‚
â”‚  â”‚  /games      â”‚  â”‚  /games/noahs-ark               â”‚   â”‚
â”‚  â”‚  page.tsx    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  (ì¹´ë“œ ì¶”ê°€)  â”‚  â”‚  â”‚  NoahsArkGame.tsx        â”‚   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  (Canvas + Game Loop)     â”‚   â”‚   â”‚
â”‚                    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚                    â”‚  â”‚  QuizModal.tsx (ë…¸ì•„ í€´ì¦ˆ) â”‚   â”‚   â”‚
â”‚                    â”‚  â”‚  GameOverModal.tsx         â”‚   â”‚   â”‚
â”‚                    â”‚  â”‚  StageClearModal.tsx       â”‚   â”‚   â”‚
â”‚                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /api/games/            â”‚
â”‚  noahs-ark/reward            â”‚
â”‚  (ë‹¬ë€íŠ¸ ë³´ìƒ ì§€ê¸‰)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL (RDS)                                      â”‚
â”‚  - Student (talentBalance)                              â”‚
â”‚  - Talent (ê±°ë˜ ê¸°ë¡, type='game')                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Data Flow

```
1. ê²Œì„ ì‹œì‘
   User â†’ /games â†’ "ë…¸ì•„ì˜ ë°©ì£¼" í´ë¦­ â†’ /games/noahs-ark
   â†’ í•™ìƒ ì„ íƒ (ë“œë¡­ë‹¤ìš´) â†’ ê²Œì„ ì‹œì‘

2. ê²Œì„ í”Œë ˆì´
   Canvas Game Loop (60fps):
   - ë¸”ë¡ ìë™ ë‚™í•˜ (íƒ€ì´ë¨¸ ê¸°ë°˜)
   - ì…ë ¥ ì²˜ë¦¬ (ì´ë™/íšŒì „/ë“œë¡­)
   - ì°©ì§€ â†’ ë³´ë“œ ê³ ì • â†’ ê· í˜• ì¬ê³„ì‚°
   - ì¤„ ì™„ì„± â†’ ì œê±° + ì ìˆ˜
   - í€´ì¦ˆ ë¸”ë¡ â†’ ì¼ì‹œì •ì§€ â†’ QuizModal
   - ëª©í‘œ ì¤„ ë‹¬ì„± â†’ StageClearModal (ë¬´ì§€ê°œ)
   - ê¼­ëŒ€ê¸° ë„ë‹¬ or ë°©ì£¼ ì „ë³µ â†’ ê²Œì„ ì˜¤ë²„

3. ê²Œì„ ì¢…ë£Œ & ë³´ìƒ
   GameOverModal â†’ POST /api/games/noahs-ark/reward
   â†’ ì„œë²„: í•™ìƒ í™•ì¸ + ì¼ì¼ ì œí•œ + ë‹¬ë€íŠ¸ ì§€ê¸‰
   â†’ ê²°ê³¼ í‘œì‹œ (ì ìˆ˜, ë³´ìƒ ë‹¬ë€íŠ¸)
```

---

## 3. File Structure

```
src/app/(dashboard)/games/
  page.tsx                            # ê²Œì„ ëª©ë¡ â€” "ë…¸ì•„ì˜ ë°©ì£¼" ì¹´ë“œ ì¶”ê°€ (ìˆ˜ì •)
  noahs-ark/
    page.tsx                          # ê²Œì„ ë˜í¼ (ì„œë²„ ì»´í¬ë„ŒíŠ¸, í•™ìƒ ëª©ë¡ ë¡œë“œ)
    _components/
      NoahsArkWrapper.tsx             # í•™ìƒ ì„ íƒ + ê²Œì„ ë˜í¼ (client)
      NoahsArkGame.tsx                # ë©”ì¸ ê²Œì„ ì»´í¬ë„ŒíŠ¸ (Canvas, client)
      QuizModal.tsx                   # ë…¸ì•„ í€´ì¦ˆ íŒì—… (client)
      GameOverModal.tsx               # ê²Œì„ ê²°ê³¼ + ë³´ìƒ (client)
      StageClearModal.tsx             # ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´ ë¬´ì§€ê°œ ì—°ì¶œ (client)
    _lib/
      types.ts                        # ê²Œì„ íƒ€ì… ì •ì˜
      blocks.ts                       # 7ì¢… í…ŒíŠ¸ë¡œë¯¸ë…¸ + ë™ë¬¼ ë§¤í•‘ + íšŒì „ ë°ì´í„°
      stages.ts                       # 5ê°œ ìŠ¤í…Œì´ì§€ ì„¤ì •
      quizData.ts                     # ë…¸ì•„ í€´ì¦ˆ 15ë¬¸ì œ (í•˜ë“œì½”ë”©)
      gameEngine.ts                   # ë³´ë“œ ë¡œì§ (ì°©ì§€, ì¤„ ì œê±°, ì¶©ëŒ ê°ì§€)
      balance.ts                      # ë°©ì£¼ ê· í˜• ê³„ì‚° (í† í¬)
      renderer.ts                     # Canvas ë Œë”ë§ (ë³´ë“œ, ë¸”ë¡, ë¹„, HUD, ê· í˜• ê²Œì´ì§€)

src/app/api/games/noahs-ark/
  reward/route.ts                     # ë‹¬ë€íŠ¸ ë³´ìƒ API (brick-breaker íŒ¨í„´ ë³µì‚¬)
```

---

## 4. Data Model (Client-side)

### 4.1 Core Types

```typescript
// types.ts

// ë¸”ë¡ ì¢…ë¥˜ (í…ŒíŠ¸ë¡œë¯¸ë…¸ 7ì¢… + í€´ì¦ˆ íŠ¹ìˆ˜)
export type BlockType = 'I' | 'O' | 'T' | 'S' | 'Z' | 'L' | 'J' | 'Q';

// ë™ë¬¼ ë§¤í•‘
export interface AnimalInfo {
  name: string;      // 'ë±€', 'ì½”ë¼ë¦¬', 'ì‚¬ì', ...
  emoji: string;     // 'ğŸ', 'ğŸ˜', 'ğŸ¦', ...
  weight: number;    // 1~5
  color: string;     // ë¸”ë¡ ìƒ‰ìƒ
}

// ë¸”ë¡ íšŒì „ ìƒíƒœ (0, 1, 2, 3 = 0Â°, 90Â°, 180Â°, 270Â°)
export type Rotation = 0 | 1 | 2 | 3;

// í˜„ì¬ ì›€ì§ì´ëŠ” ë¸”ë¡
export interface ActiveBlock {
  type: BlockType;
  rotation: Rotation;
  row: number;       // ë³´ë“œì—ì„œì˜ í–‰ ìœ„ì¹˜ (ìœ„ë¶€í„° 0)
  col: number;       // ë³´ë“œì—ì„œì˜ ì—´ ìœ„ì¹˜ (ì™¼ìª½ë¶€í„° 0)
  animal: AnimalInfo;
  isQuiz: boolean;   // í€´ì¦ˆ ë¸”ë¡ ì—¬ë¶€
}

// ë³´ë“œ ì…€ (null = ë¹„ì–´ìˆìŒ)
export interface BoardCell {
  animal: AnimalInfo;
  isQuiz: boolean;
}

// ê²Œì„ ìƒíƒœ
export type GameStatus = 'ready' | 'playing' | 'paused' | 'quiz'
  | 'stage-clear' | 'game-over' | 'all-clear';

export interface GameState {
  board: (BoardCell | null)[][];  // 20í–‰ Ã— 10ì—´
  activeBlock: ActiveBlock | null;
  nextBlock: BlockType;
  stage: number;                   // 1~5
  score: number;
  linesCleared: number;            // í˜„ì¬ ìŠ¤í…Œì´ì§€ì—ì„œ ì œê±°í•œ ì¤„ ìˆ˜
  totalLines: number;              // ì „ì²´ ì œê±°í•œ ì¤„ ìˆ˜
  status: GameStatus;
  tilt: number;                    // -1.0 ~ +1.0 (0 = ê· í˜•)
  quizCorrect: number;
  quizTotal: number;
  dropTimer: number;               // ë‹¤ìŒ ìë™ ë‚™í•˜ê¹Œì§€ ë‚¨ì€ ì‹œê°„ (ms)
}

// ìŠ¤í…Œì´ì§€ ì„¤ì •
export interface StageConfig {
  stage: number;
  targetLines: number;         // ëª©í‘œ ì¤„ ìˆ˜
  dropInterval: number;        // ë¸”ë¡ ë‚™í•˜ ê°„ê²© (ms)
  warningThreshold: number;    // ê· í˜• ê²½ê³  ì„ê³„ê°’
  gameoverThreshold: number;   // ê· í˜• ê²Œì„ì˜¤ë²„ ì„ê³„ê°’
  quizBlockCount: number;      // í€´ì¦ˆ ë¸”ë¡ ë“±ì¥ íšŸìˆ˜
  verse: string;               // ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´ ì„±ê²½ êµ¬ì ˆ
  verseRef: string;            // ì„±ê²½ ì°¸ì¡° (ì˜ˆ: "ì°½ 6:14")
  rainIntensity: number;       // ë¹„ ê°•ë„ (1~5)
}

// í€´ì¦ˆ ë°ì´í„°
export interface NoahQuiz {
  id: number;
  question: string;
  options: [string, string, string, string];
  answer: number;    // 1~4
  reference: string; // ì„±ê²½ ì°¸ì¡°
}

// ë³´ìƒ ê²°ê³¼
export interface RewardResult {
  success: boolean;
  reward: {
    talentEarned: number;
    breakdown: {
      stageClear: number;
      quizBonus: number;
    };
  };
  newBalance: number;
}
```

---

## 5. Block Definitions

### 5.1 Tetromino Shapes (blocks.ts)

ê° ë¸”ë¡ì€ 4ê°œì˜ íšŒì „ ìƒíƒœë¥¼ ê°€ì§. 4Ã—4 ë§¤íŠ¸ë¦­ìŠ¤ë¡œ í‘œí˜„.

```typescript
// blocks.ts

// ë¸”ë¡ í˜•íƒœ: 4íšŒì „ Ã— 4Ã—4 ë§¤íŠ¸ë¦­ìŠ¤ (1 = ì±„ì›Œì§, 0 = ë¹ˆì¹¸)
export const BLOCK_SHAPES: Record<BlockType, number[][][]> = {
  I: [
    [[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],  // 0Â°
    [[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],  // 90Â°
    [[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],  // 180Â°
    [[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],  // 270Â°
  ],
  O: [
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
  ],
  T: [
    [[0,1,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,0,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]],
    [[0,0,0,0],[1,1,1,0],[0,1,0,0],[0,0,0,0]],
    [[0,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],
  ],
  S: [
    [[0,1,1,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,0,0],[0,1,1,0],[0,0,1,0],[0,0,0,0]],
    [[0,0,0,0],[0,1,1,0],[1,1,0,0],[0,0,0,0]],
    [[1,0,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],
  ],
  Z: [
    [[1,1,0,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,0,1,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]],
    [[0,0,0,0],[1,1,0,0],[0,1,1,0],[0,0,0,0]],
    [[0,1,0,0],[1,1,0,0],[1,0,0,0],[0,0,0,0]],
  ],
  L: [
    [[0,0,1,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,0,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]],
    [[0,0,0,0],[1,1,1,0],[1,0,0,0],[0,0,0,0]],
    [[1,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],
  ],
  J: [
    [[1,0,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],
    [[0,0,0,0],[1,1,1,0],[0,0,1,0],[0,0,0,0]],
    [[0,1,0,0],[0,1,0,0],[1,1,0,0],[0,0,0,0]],
  ],
  Q: [ // í€´ì¦ˆ ë¸”ë¡ = Oë¸”ë¡ê³¼ ë™ì¼ í˜•íƒœ (ë¹„ë‘˜ê¸°)
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
    [[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],
  ],
};

// ë™ë¬¼ ë§¤í•‘
export const ANIMALS: Record<BlockType, AnimalInfo> = {
  I: { name: 'ë±€',     emoji: 'ğŸ', weight: 2, color: '#22c55e' },
  O: { name: 'ì½”ë¼ë¦¬', emoji: 'ğŸ˜', weight: 5, color: '#9ca3af' },
  T: { name: 'ì‚¬ì',   emoji: 'ğŸ¦', weight: 3, color: '#f97316' },
  S: { name: 'ì–‘',     emoji: 'ğŸ‘', weight: 2, color: '#e2e8f0' },
  Z: { name: 'ë…ìˆ˜ë¦¬', emoji: 'ğŸ¦…', weight: 2, color: '#a16207' },
  L: { name: 'ê¸°ë¦°',   emoji: 'ğŸ¦’', weight: 3, color: '#eab308' },
  J: { name: 'ê³°',     emoji: 'ğŸ»', weight: 4, color: '#78350f' },
  Q: { name: 'ë¹„ë‘˜ê¸°', emoji: 'ğŸ•Šï¸', weight: 1, color: '#fbbf24' },
};
```

---

## 6. Game Engine Design

### 6.1 Board Operations (gameEngine.ts)

```typescript
// ë³´ë“œ í¬ê¸°
const BOARD_ROWS = 20;
const BOARD_COLS = 10;

// ë¹ˆ ë³´ë“œ ìƒì„±
function createBoard(): (BoardCell | null)[][] {
  return Array.from({ length: BOARD_ROWS }, () => Array(BOARD_COLS).fill(null));
}

// ì¶©ëŒ ê²€ì‚¬ â€” ë¸”ë¡ì´ ë³´ë“œì— ê²¹ì¹˜ê±°ë‚˜ ë²”ìœ„ ë°–ì¸ì§€ í™•ì¸
function isValidPosition(board, block, row, col, rotation): boolean;

// ë¸”ë¡ ì°©ì§€ â€” ë³´ë“œì— ê³ ì •
function lockBlock(board, block): void;

// ì¤„ ì™„ì„± ì²´í¬ + ì œê±° â€” ì™„ì„±ëœ ì¤„ ìˆ˜ ë°˜í™˜
function clearLines(board): number;

// ê¼­ëŒ€ê¸° ë„ë‹¬ ì²´í¬
function isGameOver(board): boolean;

// ìƒˆ ë¸”ë¡ ìƒì„± (ëœë¤, í€´ì¦ˆ ë¸”ë¡ í™•ë¥  í¬í•¨)
function spawnBlock(type: BlockType): ActiveBlock;

// ëœë¤ ë¸”ë¡ íƒ€ì… ì„ íƒ (7-bag ë°©ì‹)
function getNextBlockType(quizRemaining: number): BlockType;
```

### 6.2 7-bag Randomizer

í‘œì¤€ í…ŒíŠ¸ë¦¬ìŠ¤ ëœë¤ ë°©ì‹: 7ì¢… ë¸”ë¡ì„ í•œ ì„¸íŠ¸ë¡œ ì„ì€ ë’¤ ìˆœì„œëŒ€ë¡œ ë°°ì¶œ. í€´ì¦ˆ ë¸”ë¡ì€ ì¼ì • ë¸”ë¡ ìˆ˜ë§ˆë‹¤ ì‚½ì….

```typescript
// 7ì¢… ë¸”ë¡ í•œ ì„¸íŠ¸ë¥¼ ì…”í”Œí•˜ì—¬ íì— ë„£ìŒ
// í€´ì¦ˆ ë¸”ë¡ì€ ìŠ¤í…Œì´ì§€ ì„¤ì •ì— ë”°ë¼ Nê°œ ë¸”ë¡ë§ˆë‹¤ 1ê°œì”© ì‚½ì…
// ì˜ˆ: Stage 1ì—ì„œ quizBlockCount=2 â†’ 50ë²ˆì§¸ ë¸”ë¡ë§ˆë‹¤ í€´ì¦ˆ ì‚½ì…
```

### 6.3 Balance System (balance.ts)

```typescript
// ë°©ì£¼ ê· í˜• ê³„ì‚°
function calculateTilt(board: (BoardCell | null)[][]): number {
  const center = BOARD_COLS / 2; // 5.0
  let totalTorque = 0;
  let totalWeight = 0;

  for (let r = 0; r < BOARD_ROWS; r++) {
    for (let c = 0; c < BOARD_COLS; c++) {
      const cell = board[r][c];
      if (cell) {
        const distance = c - center + 0.5; // ì¤‘ì‹¬ìœ¼ë¡œë¶€í„° ê±°ë¦¬
        totalTorque += cell.animal.weight * distance;
        totalWeight += cell.animal.weight;
      }
    }
  }

  if (totalWeight === 0) return 0;
  return totalTorque / totalWeight; // -5.0 ~ +5.0 ë²”ìœ„ (ì •ê·œí™”)
}

// ê· í˜• ìƒíƒœ íŒë³„
function getBalanceStatus(tilt: number, stage: StageConfig):
  'safe' | 'warning' | 'danger' {
  const abs = Math.abs(tilt);
  if (abs >= stage.gameoverThreshold) return 'danger';
  if (abs >= stage.warningThreshold) return 'warning';
  return 'safe';
}
```

---

## 7. Rendering Design (renderer.ts)

### 7.1 Canvas Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HUD (Stage, Score, Lines, Lives)  40px      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë³´ë“œ ì˜ì—­ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Next  â”‚
â”‚   â”‚  10ì¹¸ Ã— 20ì¹¸                   â”‚  Block â”‚
â”‚   â”‚  ê° ì…€ = CELL_SIZE px          â”‚  â”Œâ”€â”€â”  â”‚
â”‚   â”‚                                â”‚  â”‚ğŸâ”‚  â”‚
â”‚   â”‚  ë¹„ íŒŒí‹°í´ ì˜¤ë²„ë ˆì´              â”‚  â””â”€â”€â”˜  â”‚
â”‚   â”‚                                â”‚        â”‚
â”‚   â”‚  ê³ ì • ë¸”ë¡ë“¤ (ë™ë¬¼ ì´ëª¨ì§€ í‘œì‹œ)   â”‚        â”‚
â”‚   â”‚                                â”‚        â”‚
â”‚   â”‚  í˜„ì¬ ë¸”ë¡ (ê³ ìŠ¤íŠ¸ ë¸”ë¡ í¬í•¨)    â”‚        â”‚
â”‚   â”‚                                â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                              â”‚
â”‚   âš–ï¸ â”â”â”â”â”â”â”â”â—â”â”â”â”â”â”â”â” âš–ï¸  ê· í˜• ê²Œì´ì§€       â”‚
â”‚                                              â”‚
â”‚   [â†] [â†»] [â†’] [â–¼]  ëª¨ë°”ì¼ í„°ì¹˜ ë²„íŠ¼          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 Rendering Functions

```typescript
// renderer.ts

// ë©”ì¸ ë Œë”
function drawGame(ctx, state, canvasW, canvasH): void;

// ë³´ë“œ ê·¸ë¦¬ë“œ + ê³ ì • ë¸”ë¡
function drawBoard(ctx, board, offsetX, offsetY, cellSize): void;

// í˜„ì¬ í™œì„± ë¸”ë¡ + ê³ ìŠ¤íŠ¸(ì°©ì§€ ë¯¸ë¦¬ë³´ê¸°)
function drawActiveBlock(ctx, block, offsetX, offsetY, cellSize): void;
function drawGhostBlock(ctx, board, block, offsetX, offsetY, cellSize): void;

// ë‹¤ìŒ ë¸”ë¡ ë¯¸ë¦¬ë³´ê¸°
function drawNextBlock(ctx, blockType, x, y, cellSize): void;

// ê· í˜• ê²Œì´ì§€ ë°”
function drawBalanceGauge(ctx, tilt, warningThreshold, gameoverThreshold, x, y, width): void;

// HUD (Stage, Score, Lines)
function drawHUD(ctx, state, canvasW): void;

// ë¹„ íŒŒí‹°í´
function updateRainParticles(particles, intensity, canvasW, canvasH): void;
function drawRain(ctx, particles): void;

// Ready í™”ë©´
function drawReadyScreen(ctx, canvasW, canvasH, stage): void;

// ì¼ì‹œì •ì§€ ì˜¤ë²„ë ˆì´
function drawPausedOverlay(ctx, canvasW, canvasH): void;

// ëª¨ë°”ì¼ í„°ì¹˜ ë²„íŠ¼
function drawTouchButtons(ctx, canvasW, canvasH): { left, right, rotate, drop } (ì˜ì—­ ì¢Œí‘œ);
```

### 7.3 Rain Particle System

```typescript
interface RainDrop {
  x: number;
  y: number;
  speed: number;
  length: number;
  opacity: number;
}

// Stageë³„ ë¹„ ê°•ë„:
// Stage 1: ê°€ë²¼ìš´ ë¹„ (30 íŒŒí‹°í´)
// Stage 2: ë³´í†µ ë¹„ (60 íŒŒí‹°í´)
// Stage 3: ê°•í•œ ë¹„ (100 íŒŒí‹°í´)
// Stage 4: í­ìš° (150 íŒŒí‹°í´)
// Stage 5: ëŒ€í­ìš° (200 íŒŒí‹°í´)

// ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´ ì‹œ: ë¹„ íŒŒí‹°í´ ì ì§„ ê°ì†Œ â†’ 0 â†’ ë¬´ì§€ê°œ ìƒì„±
```

---

## 8. Stage Configuration (stages.ts)

```typescript
export const STAGES: StageConfig[] = [
  {
    stage: 1,
    targetLines: 10,
    dropInterval: 1000,
    warningThreshold: 2.5,
    gameoverThreshold: 4.0,
    quizBlockCount: 2,
    verse: 'í•˜ë‚˜ë‹˜ì´ ë…¸ì•„ì—ê²Œ ì´ë¥´ì‹œë˜ ë„ˆëŠ” ë°©ì£¼ë¥¼ ì§€ìœ¼ë¼',
    verseRef: 'ì°½ì„¸ê¸° 6:14',
    rainIntensity: 1,
  },
  {
    stage: 2,
    targetLines: 15,
    dropInterval: 800,
    warningThreshold: 2.0,
    gameoverThreshold: 3.5,
    quizBlockCount: 3,
    verse: 'ë…¸ì•„ê°€ ëª¨ë“  ê²ƒì„ í•˜ë‚˜ë‹˜ì´ ëª…í•˜ì‹  ëŒ€ë¡œ í–‰í•˜ì˜€ë”ë¼',
    verseRef: 'ì°½ì„¸ê¸° 6:22',
    rainIntensity: 2,
  },
  {
    stage: 3,
    targetLines: 20,
    dropInterval: 650,
    warningThreshold: 1.8,
    gameoverThreshold: 3.0,
    quizBlockCount: 4,
    verse: 'ì—¬í˜¸ì™€ê»˜ì„œ ê·¸ ë’¤ë¥¼ ë‹«ìœ¼ì‹œë‹ˆë¼',
    verseRef: 'ì°½ì„¸ê¸° 7:16',
    rainIntensity: 3,
  },
  {
    stage: 4,
    targetLines: 25,
    dropInterval: 500,
    warningThreshold: 1.5,
    gameoverThreshold: 2.5,
    quizBlockCount: 5,
    verse: 'ë¬¼ì´ ë•…ì—ì„œ ì¤„ì–´ë“¤ê¸° ì‹œì‘í•˜ì—¬',
    verseRef: 'ì°½ì„¸ê¸° 8:3',
    rainIntensity: 4,
  },
  {
    stage: 5,
    targetLines: 30,
    dropInterval: 400,
    warningThreshold: 1.2,
    gameoverThreshold: 2.0,
    quizBlockCount: 6,
    verse: 'ë‚´ê°€ ë¬´ì§€ê°œë¥¼ êµ¬ë¦„ ì†ì— ë‘ì—ˆë‚˜ë‹ˆ ì´ê²ƒì´ ë‚˜ì™€ ì„¸ìƒ ì‚¬ì´ì˜ ì–¸ì•½ì˜ ì¦ê±°ë‹ˆë¼',
    verseRef: 'ì°½ì„¸ê¸° 9:13',
    rainIntensity: 5,
  },
];
```

---

## 9. Quiz Data (quizData.ts)

```typescript
export const NOAH_QUIZZES: NoahQuiz[] = [
  {
    id: 1,
    question: 'ë…¸ì•„ê°€ ë°©ì£¼ë¥¼ ë§Œë“  ë‚˜ë¬´ëŠ” ë¬´ì—‡ì¸ê°€ìš”?',
    options: ['ì†Œë‚˜ë¬´', 'ì£ë‚˜ë¬´ (ê³ í˜ë¥´ ë‚˜ë¬´)', 'ë–¡ê°ˆë‚˜ë¬´', 'ì˜¬ë¦¬ë¸Œë‚˜ë¬´'],
    answer: 2,
    reference: 'ì°½ì„¸ê¸° 6:14',
  },
  {
    id: 2,
    question: 'ë°©ì£¼ì— ë“¤ì–´ê°„ ë™ë¬¼ì€ ê°ê° ëª‡ ìŒì”© ë“¤ì–´ê°”ë‚˜ìš”?',
    options: ['1ìŒ', '2ìŒ', '3ìŒ', '5ìŒ'],
    answer: 2,
    reference: 'ì°½ì„¸ê¸° 7:2',
  },
  {
    id: 3,
    question: 'ë¹„ê°€ ë©°ì¹  ë™ì•ˆ ë‚´ë ¸ë‚˜ìš”?',
    options: ['7ì¼', '20ì¼', '40ì¼', '100ì¼'],
    answer: 3,
    reference: 'ì°½ì„¸ê¸° 7:12',
  },
  {
    id: 4,
    question: 'ë…¸ì•„ê°€ ë°©ì£¼ì—ì„œ ì²˜ìŒ ë³´ë‚¸ ìƒˆëŠ”?',
    options: ['ë¹„ë‘˜ê¸°', 'ê¹Œë§ˆê·€', 'ì°¸ìƒˆ', 'ë…ìˆ˜ë¦¬'],
    answer: 2,
    reference: 'ì°½ì„¸ê¸° 8:7',
  },
  {
    id: 5,
    question: 'ì˜¬ë¦¬ë¸Œ ìì„ ë¬¼ê³  ëŒì•„ì˜¨ ìƒˆëŠ”?',
    options: ['ê¹Œë§ˆê·€', 'ë¹„ë‘˜ê¸°', 'ì°¸ìƒˆ', 'ì•µë¬´ìƒˆ'],
    answer: 2,
    reference: 'ì°½ì„¸ê¸° 8:11',
  },
  {
    id: 6,
    question: 'í•˜ë‚˜ë‹˜ì´ ë‹¤ì‹œëŠ” í™ìˆ˜ë¡œ ë©¸í•˜ì§€ ì•Šê² ë‹¤ëŠ” ì•½ì†ì˜ í‘œì‹œëŠ”?',
    options: ['ë³„', 'ë¬´ì§€ê°œ', 'êµ¬ë¦„', 'ë²ˆê°œ'],
    answer: 2,
    reference: 'ì°½ì„¸ê¸° 9:13',
  },
  {
    id: 7,
    question: 'ë…¸ì•„ì˜ ì„¸ ì•„ë“¤ ì´ë¦„ì´ ì•„ë‹Œ ê²ƒì€?',
    options: ['ì…ˆ', 'í•¨', 'ì•¼ë²³', 'ì•„ë²¨'],
    answer: 4,
    reference: 'ì°½ì„¸ê¸° 6:10',
  },
  {
    id: 8,
    question: 'ë°©ì£¼ì˜ ê¸¸ì´ëŠ” ëª‡ ê·œë¹—ì¸ê°€ìš”?',
    options: ['100ê·œë¹—', '200ê·œë¹—', '300ê·œë¹—', '400ê·œë¹—'],
    answer: 3,
    reference: 'ì°½ì„¸ê¸° 6:15',
  },
  {
    id: 9,
    question: 'ë°©ì£¼ëŠ” ëª‡ ì¸µìœ¼ë¡œ ë§Œë“¤ì—ˆë‚˜ìš”?',
    options: ['1ì¸µ', '2ì¸µ', '3ì¸µ', '4ì¸µ'],
    answer: 3,
    reference: 'ì°½ì„¸ê¸° 6:16',
  },
  {
    id: 10,
    question: 'ë…¸ì•„ì˜ í™ìˆ˜ ì´ì•¼ê¸°ëŠ” ì°½ì„¸ê¸° ëª‡ ì¥ì— ìˆë‚˜ìš”?',
    options: ['1~3ì¥', '4~5ì¥', '6~9ì¥', '10~12ì¥'],
    answer: 3,
    reference: 'ì°½ì„¸ê¸° 6~9ì¥',
  },
  {
    id: 11,
    question: 'ë°©ì£¼ê°€ ë¨¸ë¬¸ ì‚°ì˜ ì´ë¦„ì€?',
    options: ['ì‹œë‚˜ì´ì‚°', 'ì•„ë¼ëì‚°', 'ê°ˆë©œì‚°', 'í˜¸ë ™ì‚°'],
    answer: 2,
    reference: 'ì°½ì„¸ê¸° 8:4',
  },
  {
    id: 12,
    question: 'ë…¸ì•„ì˜ ë‚˜ì´ê°€ í™ìˆ˜ ë•Œ ëª‡ ì‚´ì´ì—ˆë‚˜ìš”?',
    options: ['500ì‚´', '600ì‚´', '700ì‚´', '800ì‚´'],
    answer: 2,
    reference: 'ì°½ì„¸ê¸° 7:6',
  },
  {
    id: 13,
    question: 'ë°©ì£¼ì˜ ë„ˆë¹„ëŠ” ëª‡ ê·œë¹—ì¸ê°€ìš”?',
    options: ['30ê·œë¹—', '40ê·œë¹—', '50ê·œë¹—', '60ê·œë¹—'],
    answer: 3,
    reference: 'ì°½ì„¸ê¸° 6:15',
  },
  {
    id: 14,
    question: 'í•˜ë‚˜ë‹˜ì´ ë…¸ì•„ì—ê²Œ ë°©ì£¼ë¥¼ ì§“ê²Œ í•œ ì´ìœ ëŠ”?',
    options: ['ì—¬í–‰ì„ ìœ„í•´', 'ì„¸ìƒì´ ì•…í•´ì ¸ì„œ', 'ë°”ë‹¤ë¥¼ ê±´ë„ˆë ¤ê³ ', 'ë³´ë¬¼ì„ ìˆ¨ê¸°ë ¤ê³ '],
    answer: 2,
    reference: 'ì°½ì„¸ê¸° 6:13',
  },
  {
    id: 15,
    question: 'í™ìˆ˜ í›„ ë…¸ì•„ê°€ ì²˜ìŒ í•œ ì¼ì€?',
    options: ['ì§‘ì„ ì§€ì—ˆë‹¤', 'ì œë‹¨ì„ ìŒ“ì•˜ë‹¤', 'ë†ì‚¬ë¥¼ ì§€ì—ˆë‹¤', 'ë‚˜ë¬´ë¥¼ ì‹¬ì—ˆë‹¤'],
    answer: 2,
    reference: 'ì°½ì„¸ê¸° 8:20',
  },
];
```

---

## 10. API Specification

### 10.1 POST /api/games/noahs-ark/reward

brick-breaker/rewardì™€ ë™ì¼ íŒ¨í„´. `reason` ë¬¸ìì—´ë§Œ ë‹¤ë¦„.

**Request:**
```json
{
  "studentId": "string",
  "score": 2400,
  "stageCleared": 3,
  "quizCorrect": 2,
  "quizTotal": 4
}
```

**Response (200 OK):**
```json
{
  "success": true,
  "reward": {
    "talentEarned": 5,
    "breakdown": {
      "stageClear": 3,
      "quizBonus": 2
    }
  },
  "newBalance": 50
}
```

**ë³´ìƒ ë¡œì§** (brick-breakerì™€ ë™ì¼):
```
if stageCleared >= 1: reward += 1
if stageCleared >= 3: reward += 2  (ì´ 3)
if stageCleared >= 5: reward += 2  (ì´ 5)
if quizCorrect == quizTotal && quizTotal > 0: reward += 2
```

**ì¼ì¼ ì œí•œ**: í•˜ë£¨ 3íšŒ (Talent í…Œì´ë¸”, `reason LIKE '%ë…¸ì•„ì˜ ë°©ì£¼%'`)

---

## 11. UI/UX Design

### 11.1 ê²Œì„ ëª©ë¡ ì¹´ë“œ (ìˆ˜ì •)

```
games/page.tsxì—ì„œ Coming Soon â†’ ë…¸ì•„ì˜ ë°©ì£¼ë¡œ êµì²´:
{
  id: 'noahs-ark',
  title: 'ë…¸ì•„ì˜ ë°©ì£¼',
  description: 'ë™ë¬¼ë“¤ì„ ë°©ì£¼ì— ë¹ˆí‹ˆì—†ì´ íƒœì›Œë³´ì„¸ìš”!',
  emoji: 'ğŸš¢',
  href: '/games/noahs-ark',
  available: true,
}
```

### 11.2 í€´ì¦ˆ ëª¨ë‹¬ (QuizModal.tsx)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ğŸ•Šï¸ ë…¸ì•„ì˜ ë°©ì£¼ í€´ì¦ˆ!        â”‚
â”‚                                      â”‚
â”‚  ë¹„ê°€ ë©°ì¹  ë™ì•ˆ ë‚´ë ¸ë‚˜ìš”?              â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â‘  7ì¼                       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â‘¡ 20ì¼                      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â‘¢ 40ì¼                 âœ…   â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â‘£ 100ì¼                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚
â”‚  ì°¸ì¡°: ì°½ì„¸ê¸° 7:12                    â”‚
â”‚                                      â”‚
â”‚         [ê³„ì†í•˜ê¸°]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.3 ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´ ëª¨ë‹¬ (StageClearModal.tsx)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                      â”‚
â”‚          ğŸŒˆ ë¬´ì§€ê°œ ì• ë‹ˆë©”ì´ì…˜ ğŸŒˆ       â”‚
â”‚                                      â”‚
â”‚        Stage 3 í´ë¦¬ì–´!                â”‚
â”‚                                      â”‚
â”‚  "ì—¬í˜¸ì™€ê»˜ì„œ ê·¸ ë’¤ë¥¼ ë‹«ìœ¼ì‹œë‹ˆë¼"       â”‚
â”‚                  â€” ì°½ì„¸ê¸° 7:16        â”‚
â”‚                                      â”‚
â”‚  ì œê±°í•œ ì¤„: 20  |  ì ìˆ˜: 4,200        â”‚
â”‚                                      â”‚
â”‚         [ë‹¤ìŒ ìŠ¤í…Œì´ì§€ â†’]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.4 ê²Œì„ ì˜¤ë²„ ëª¨ë‹¬ (GameOverModal.tsx)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ê²Œì„ ì˜¤ë²„ / ì¶•í•˜í•©ë‹ˆë‹¤!       â”‚
â”‚                                      â”‚
â”‚  (ë°©ì£¼ê°€ ì „ë³µ / ì˜¬í´ë¦¬ì–´)              â”‚
â”‚                                      â”‚
â”‚  ìµœì¢… ì ìˆ˜: 8,200                     â”‚
â”‚  ì´ ì œê±° ì¤„: 45                       â”‚
â”‚  í€´ì¦ˆ: 8/10 ì •ë‹µ                      â”‚
â”‚  ë‹¬ë€íŠ¸: +5 + 2 = 7                   â”‚
â”‚                                      â”‚
â”‚  [ë³´ìƒ ë°›ê¸°] [ë‹¤ì‹œí•˜ê¸°] [ëª©ë¡ìœ¼ë¡œ]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.5 Mobile Touch Controls

```
ëª¨ë°”ì¼ í™”ë©´ í•˜ë‹¨ì— í„°ì¹˜ ë²„íŠ¼ ì˜ì—­:

â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ â†  â”‚ â†»  â”‚ â†’  â”‚ â–¼  â”‚
â”‚ì™¼ìª½â”‚íšŒì „â”‚ì˜¤ë¥¸â”‚ë“œë¡­â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

ì¶”ê°€ë¡œ ìŠ¤ì™€ì´í”„ ì œìŠ¤ì²˜ ì§€ì›:
- ì™¼ìª½ ìŠ¤ì™€ì´í”„: ì™¼ìª½ ì´ë™
- ì˜¤ë¥¸ìª½ ìŠ¤ì™€ì´í”„: ì˜¤ë¥¸ìª½ ì´ë™
- ìœ„ ìŠ¤ì™€ì´í”„: íšŒì „
- ì•„ë˜ ìŠ¤ì™€ì´í”„: ì†Œí”„íŠ¸ ë“œë¡­
- ì•„ë˜ ë¹ ë¥¸ ìŠ¤ì™€ì´í”„: í•˜ë“œ ë“œë¡­
```

---

## 12. Input Handling

### 12.1 Desktop (Keyboard)

| Key | Action |
|-----|--------|
| ArrowLeft | ë¸”ë¡ ì™¼ìª½ ì´ë™ |
| ArrowRight | ë¸”ë¡ ì˜¤ë¥¸ìª½ ì´ë™ |
| ArrowDown | ì†Œí”„íŠ¸ ë“œë¡­ (ë¹ ë¥¸ ë‚™í•˜) |
| ArrowUp / Z | ì‹œê³„ ë°©í–¥ íšŒì „ |
| Space | í•˜ë“œ ë“œë¡­ (ì¦‰ì‹œ ì°©ì§€) |
| Escape / P | ì¼ì‹œì •ì§€/ì¬ê°œ |

### 12.2 Mobile (Touch)

| Gesture | Action |
|---------|--------|
| í„°ì¹˜ ë²„íŠ¼ â† | ì™¼ìª½ ì´ë™ |
| í„°ì¹˜ ë²„íŠ¼ â†’ | ì˜¤ë¥¸ìª½ ì´ë™ |
| í„°ì¹˜ ë²„íŠ¼ â†» | íšŒì „ |
| í„°ì¹˜ ë²„íŠ¼ â–¼ | í•˜ë“œ ë“œë¡­ |
| ë³´ë“œ íƒ­ | íšŒì „ |
| ë³´ë“œ ì¢Œ ìŠ¤ì™€ì´í”„ | ì™¼ìª½ ì´ë™ |
| ë³´ë“œ ìš° ìŠ¤ì™€ì´í”„ | ì˜¤ë¥¸ìª½ ì´ë™ |
| ë³´ë“œ í•˜ ìŠ¤ì™€ì´í”„ | ì†Œí”„íŠ¸ ë“œë¡­ |

---

## 13. Scoring System

| Action | Points |
|--------|--------|
| ë¸”ë¡ ì°©ì§€ (ì†Œí”„íŠ¸ ë“œë¡­) | 1 Ã— ë‚™í•˜í•œ ì¹¸ ìˆ˜ |
| í•˜ë“œ ë“œë¡­ | 2 Ã— ë‚™í•˜í•œ ì¹¸ ìˆ˜ |
| 1ì¤„ ì œê±° (Single) | 100 |
| 2ì¤„ ë™ì‹œ ì œê±° (Double) | 300 |
| 3ì¤„ ë™ì‹œ ì œê±° (Triple) | 500 |
| 4ì¤„ ë™ì‹œ ì œê±° (Tetris) | 800 |
| í€´ì¦ˆ ì •ë‹µ | +200 |
| í€´ì¦ˆ ì˜¤ë‹µ | +50 |
| ê· í˜• ìœ ì§€ ë³´ë„ˆìŠ¤ (ì¤„ ì œê±° ì‹œ tilt < 0.5) | +50 |

---

## 14. Security & Anti-Abuse

brick-breakerì™€ ë™ì¼ íŒ¨í„´:
- ì„œë²„ì—ì„œ ì¼ì¼ ë³´ìƒ íšŸìˆ˜ í™•ì¸ (Talent í…Œì´ë¸”, reason LIKE '%ë…¸ì•„ì˜ ë°©ì£¼%')
- í•˜ë£¨ ìµœëŒ€ 3íšŒ
- stageCleared 1~5, quizCorrect <= quizTotal ê²€ì¦

---

## 15. Implementation Order

### 15.1 êµ¬í˜„ ìˆœì„œ

1. [ ] **íƒ€ì… ì •ì˜** (`_lib/types.ts`)
   - BlockType, AnimalInfo, ActiveBlock, BoardCell, GameState, StageConfig, NoahQuiz

2. [ ] **ë¸”ë¡ ì •ì˜** (`_lib/blocks.ts`)
   - 7ì¢… í…ŒíŠ¸ë¡œë¯¸ë…¸ íšŒì „ ë§¤íŠ¸ë¦­ìŠ¤, ë™ë¬¼ ë§¤í•‘, ëœë¤ ìƒì„±

3. [ ] **ìŠ¤í…Œì´ì§€ ë°ì´í„°** (`_lib/stages.ts`)
   - 5ê°œ ìŠ¤í…Œì´ì§€ ì„¤ì • (ì†ë„, ê· í˜• ì„ê³„ê°’, ì„±ê²½ êµ¬ì ˆ)

4. [ ] **í€´ì¦ˆ ë°ì´í„°** (`_lib/quizData.ts`)
   - ë…¸ì•„ ê´€ë ¨ 15ë¬¸ì œ í•˜ë“œì½”ë”©

5. [ ] **ê· í˜• ì—”ì§„** (`_lib/balance.ts`)
   - í† í¬ ê³„ì‚°, ê· í˜• ìƒíƒœ íŒë³„

6. [ ] **ê²Œì„ ì—”ì§„** (`_lib/gameEngine.ts`)
   - ë³´ë“œ ìƒì„±, ì¶©ëŒ ê°ì§€, ë¸”ë¡ ì°©ì§€, ì¤„ ì œê±°, 7-bag ëœë¤

7. [ ] **ë Œë”ëŸ¬** (`_lib/renderer.ts`)
   - ë³´ë“œ/ë¸”ë¡/HUD/ê· í˜• ê²Œì´ì§€/ë¹„ íŒŒí‹°í´/ëª¨ë°”ì¼ ë²„íŠ¼ ë Œë”ë§

8. [ ] **ë©”ì¸ ê²Œì„ ì»´í¬ë„ŒíŠ¸** (`_components/NoahsArkGame.tsx`)
   - Canvas ì´ˆê¸°í™”, ê²Œì„ ë£¨í”„, ì…ë ¥ ì²˜ë¦¬, ìƒíƒœ ê´€ë¦¬

9. [ ] **í€´ì¦ˆ ëª¨ë‹¬** (`_components/QuizModal.tsx`)
   - 4ì§€ì„ ë‹¤ UI, ì •ë‹µ/ì˜¤ë‹µ, ê³„ì†í•˜ê¸°

10. [ ] **ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´ ëª¨ë‹¬** (`_components/StageClearModal.tsx`)
    - ë¬´ì§€ê°œ CSS ì• ë‹ˆë©”ì´ì…˜, ì„±ê²½ êµ¬ì ˆ, ë‹¤ìŒ ìŠ¤í…Œì´ì§€

11. [ ] **ê²Œì„ ì˜¤ë²„ ëª¨ë‹¬** (`_components/GameOverModal.tsx`)
    - ê²°ê³¼ í‘œì‹œ, ë³´ìƒ ìš”ì²­, ë‹¤ì‹œí•˜ê¸°/ëª©ë¡ìœ¼ë¡œ

12. [ ] **ê²Œì„ ë˜í¼** (`_components/NoahsArkWrapper.tsx`)
    - í•™ìƒ ì„ íƒ ë“œë¡­ë‹¤ìš´

13. [ ] **ê²Œì„ í˜ì´ì§€** (`games/noahs-ark/page.tsx`)
    - ì„œë²„ ì»´í¬ë„ŒíŠ¸, í•™ìƒ ëª©ë¡ ë¡œë“œ

14. [ ] **ë³´ìƒ API** (`api/games/noahs-ark/reward/route.ts`)
    - brick-breaker íŒ¨í„´ ë³µì‚¬, reason ë³€ê²½

15. [ ] **ê²Œì„ ëª©ë¡ ìˆ˜ì •** (`games/page.tsx`)
    - Coming Soon â†’ ë…¸ì•„ì˜ ë°©ì£¼ ì¹´ë“œ í™œì„±í™”

---

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 0.1 | 2026-02-16 | Initial draft | AI Assistant |
